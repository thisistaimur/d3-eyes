<HTML>
<HEAD>
    <META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
    <TITLE>Simple heatmap implementation for adsatagazer</TITLE>
    <script src="https://d3js.org/d3.v5.js"></script>
    <script src="https://d3js.org/d3-hexbin.v0.2.min.js"></script>
    <script src="js/webgazer2.js"></script>
    <script src="js/app.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <link rel="stylesheet" href="index.css">

    <style type="text/css">
	body {
	font-family: sans-serif;
}

    .hexagons {
      fill: none;
      stroke: #fff;
      stroke-opacity: 0.5;
}

    </style>
</HEAD>

<BODY LANG="en-US" LINK="#0000ff" DIR="LTR">
    

<div>
	<div id="header">
        <a class="navbar-nav" href="https://adsata.com"><h2>Zights Hex Bins</h2></a>
	</div>
    <div id="context" >
        <div id="focus">
            <img src="inputUpload" class="img"> Upload </img>

        </div>
        <span>
            <div class="input-group mb-3">
                <div class="input-group-prepend">
                </div>
            <input  type="file" id="inputUpload">Upload Image</input>
            </div>
            <button type="button" class="btn btn-success" id="buttonStart" onClick="webgazer.begin()">Start</button>
            <button type="button" class="btn btn-warning" id="buttonPause" onClick="webgazer.pause()">Pause</button>
            <button type="button" class="btn btn-secondary" id="buttonResume" onClick="webgazer.resume()">Resume</button>
            <button type="button" class="btn btn-danger" id="buttonFinish" onClick="render(15)">Finish</button>
        </span>
	<br>
        <input type="range" min="10" max="25" value="15" id="hexRadius">Radius</input>
	<br>
	<input type="range" min="0" max="1" step="0.1" value=".5" id="hexOpacity">Opacity</input>
    </div>
    
</div>



<script>
// Init the svg to which we will be working on
//var width = window.innerWidth,height = window.innerHeight *.75,
var svg = d3.select("#focus").append("svg");
                            
	//.style("clip-path", "url(#focus)");
  
//Add listener to insert the photo
d3.select("#inputUpload").on("change", function() {
    var reader = new FileReader();
    reader.onloadend = function (e) {
	var image = new Image();
	image.src = e.target.result;

	image.onload = function() {
		svg.attr("width", this.width).attr("height", this.height);
		d3.select("#focus")
			.style("background-image", "url(" + e.target.result +")")
            .style("background-repeat", "no-repeat")
            .style("width", "100%");
            
	};
    };
    reader.readAsDataURL(this.files[0]);
});

//Set listener for the radius slider
d3.select("#hexRadius").on("change", function() {
    return render(+this.value);
});

d3.select("#hexOpcaity").on("change", function() {
    return d3.selectAll(".hexagons").style("opacity", +this.value);
});

</script>
</BODY>
</HTML>
